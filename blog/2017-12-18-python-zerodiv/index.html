<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="//gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.75.1" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Why Python&#39;s ZeroDivisionError for floating-point type is a bad and unnecessary feature &middot; Wu Sun, Ph.D.</title>

  
  <link type="text/css" rel="stylesheet" href="https://wusun.name/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://wusun.name/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://wusun.name/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://wusun.name/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Wu Sun, Ph.D." />

  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
          delimiters: [
              {left: "$$", right: "$$", display: true},
              {left: "\\(", right: "\\)", display: false},
              {left: "$", right: "$", display: false},
              {left: "\\[", right: "\\]", display: true}
          ]
      });
  });
</script>

</head>

  <body class="theme-material-green-800 ">
  <link href="/css/academicons.min.css" rel="stylesheet">
<link href="/css/fontawesome.css" rel="stylesheet">
<link href="/css/brands.css" rel="stylesheet">
<link href="/css/solid.css" rel="stylesheet">

<aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://wusun.name/"><h1>Wu Sun, Ph.D.</h1></a>
      <p class="lead">
       carbon cycle, climate, photosynthesis, soils, and exotic trace gases 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        
        
        <li><a href="/"> Home </a></li><li><a href="/research/"> Research </a></li><li><a href="/publications/"> Publications </a></li><li><a href="/data/"> Data &amp; Code </a></li><li><a href="/teaching/"> Teaching </a></li><li><a href="/cv/"> CV </a></li><li><a href="/blog/"> Blog </a></li>
      </ul>
    </nav>

    <div class="sidebar-about">
      <font size="3">
      <p>
        
        <a href="https://github.com/wusunlab">
          <i class="fab fa-github" aria-hidden="true"></i>
          <span class="username">wusunlab</span>
        </a>
        
        <br>
        
        <a href="https://scholar.google.com/citations?user=YjkYTeoAAAAJ">
          <i class="ai ai-google-scholar-square" aria-hidden="true"></i>
          <span class="username">Google Scholar</span>
        </a>
        
        <br>
        
        <a href="https://orcid.org/0000-0002-2333-6282">
          <i class="ai ai-orcid-square" aria-hidden="true"></i>
          <span class="username">ORCID</span>
        </a>
        
        <br>
        
        <a class="u-email" href="mailto:wusun@protonmail.com">
          <i class="fas fa-envelope" aria-hidden="true"></i>
          <span class="username">wusun@protonmail.com</span>
        </a>
        
      </p>
      </font>
    </div>

    <p>© 2019–2020 Wu Sun. All rights reserved.</p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>Why Python&#39;s ZeroDivisionError for floating-point type is a bad and unnecessary feature</h1>
  <time datetime=2017-12-18T00:00:00Z class="post-date">Mon, Dec 18, 2017</time>
  <p>In Python 2.7 and 3.6, dividing a floating-point number by zero results in a
<code>ZeroDivisionError</code>:</p>
<pre><code>&gt;&gt;&gt; 1. / 0.
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
ZeroDivisionError: float division by zero
</code></pre><p><strong>This is not consistent with mathematics</strong>, given that $1 / 0 = \infty$.
Wouldn&rsquo;t it be better to just return <code>inf</code>? In fact, the exception &ldquo;division by
zero&rdquo; has been stipulated to return infinities in the IEEE 754 standard for
floating-point arithmetic [1]:</p>
<blockquote>
<p>The default result of divideByZero shall be an ∞ correctly signed according
to the operation . . .</p>
</blockquote>
<p>In many programming languages, the expression <code>1. / 0.</code> gives the positive
infinity without raising an error; like in Julia, for example,</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">julia<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">1.</span> <span style="color:#000;font-weight:bold">/</span> <span style="color:#099">0.</span>
<span style="color:#0086b3">Inf</span>
</code></pre></div><p>In C, the expression <code>1. / 0.</code> can sometimes be used to define the infinity
that is compiler independent (before the C99 standard),</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#999;font-weight:bold;font-style:italic">#ifndef INFINITY
</span><span style="color:#999;font-weight:bold;font-style:italic">#define INFINITY 1. / 0.
</span><span style="color:#999;font-weight:bold;font-style:italic">#endif
</span></code></pre></div><p>The fact that Python raises a <code>ZeroDivisionError</code> instead of returning <code>inf</code>
from zero division seems to be in violation of the IEEE 754 standard.</p>
<p>There is also a special case where both the dividend and the divisor are zero.
How this exception should be handled has not been specified in the IEEE 754
standard. In many programming languages, <code>0. / 0.</code> is evaluated as <code>NaN</code>. In
Haskell, for example,</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-haskell" data-lang="haskell"><span style="color:#900;font-weight:bold">ghci</span><span style="color:#000;font-weight:bold">&gt;</span> (<span style="color:#099">0</span> <span style="color:#000;font-weight:bold">::</span> <span style="color:#458;font-weight:bold">Double</span>) <span style="color:#000;font-weight:bold">/</span> (<span style="color:#099">0</span> <span style="color:#000;font-weight:bold">::</span> <span style="color:#458;font-weight:bold">Double</span>)
<span style="color:#458;font-weight:bold">NaN</span>
</code></pre></div><p>The aforementioned mechanism for handling the division by zero exceptions has
an important advantage &mdash; it ensures that the division between two
floating-point numbers returns a floating-number type, no matter what. In
mathematical terms, the set of floating-point numbers has <strong>closure</strong> under the
operation of <strong>division</strong>. The resulting <code>NaN</code> or <code>Inf</code> values can be easily
tested with standard library functions like <code>isnan()</code> and <code>isinf()</code>. This also
has a practical benefit to skip the hassle of error handling.</p>
<p>But in Python, one has to catch the <code>ZeroDivisionError</code> first with the <code>try</code>
and <code>except</code> statement.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">zerodiv</span>(a, b):
    <span style="color:#d14">&#34;&#34;&#34;Division that overrides the ZeroDivisionError.&#34;&#34;&#34;</span>
    <span style="color:#000;font-weight:bold">try</span>:
        <span style="color:#000;font-weight:bold">return</span> a <span style="color:#000;font-weight:bold">/</span> b
    <span style="color:#000;font-weight:bold">except</span> <span style="color:#900;font-weight:bold">ZeroDivisionError</span>:
        <span style="color:#000;font-weight:bold">if</span> b <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0.</span>:
            <span style="color:#000;font-weight:bold">if</span> a <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">0.</span>:
                <span style="color:#000;font-weight:bold">return</span> <span style="color:#0086b3">float</span>(<span style="color:#d14">&#39;NaN&#39;</span>)
            <span style="color:#000;font-weight:bold">else</span>:
                <span style="color:#000;font-weight:bold">return</span> <span style="color:#0086b3">float</span>(<span style="color:#d14">&#39;Inf&#39;</span>)
</code></pre></div><p>In other words, with the floating-point <code>ZeroDivisionError</code>, Python has created
a problem that does not even exist in other languages!</p>
<p>Why does Python have the <code>ZeroDivisionError</code> for floating-point arithmetic in
the first place? I cannot find a justification after a bit of searching. I have
the impression that the floating-point <code>ZeroDivisionError</code> is mimicking the
integer version of the error. This is an unnecessary and bad feature, because
it violates the closure of the floating-point type and costs additional code
for error handling. I hope this flaw could be righted in Python 4.</p>
<h2 id="references">References</h2>
<ol>
<li>Zuras, D. <em>et al.</em> (2008). IEEE Standard for Floating-Point Arithmetic.
<em>IEEE Std 754-2008</em>, 1–70, doi:10.1109/ieeestd.2008.4610935.</li>
</ol>

</div>


    </main>

    
      
    
  </body>
</html>
